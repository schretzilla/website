var index=angular.module("index",[]);index.config(function(e){e.startSymbol("{[{"),e.endSymbol("}]}")}),index.config(["$httpProvider",function(e){e.defaults.xsrfCookieName="csrftoken",e.defaults.xsrfHeaderName="X-CSRFToken"}]),index.controller("QuizCtrl",function(e,u,i){e.loadItems=function(){getQuizzes().then(function(u){e.quizes=u.data})},e.addQuiz=function(){e.date=new Date,quiz={user:e.userId,quiz_name:e.quizName,quiz_details:e.quizDetails,date_created:e.date},e.quizName=null,e.quizDetails=null,postQuiz(quiz).then(function(u){e.loadItems()})},e.removeQuiz=function(u){deleteQuiz(u).then(function(){e.loadItems()})},e.shareQuiz=function(u){e.curQuiz=u,userQuizAvailable=[],getQuizUsers(u.id).then(function(u){e.quizUsers=u.data,getUsers().then(function(u){e.users=u.data})},function(e){alert("Could not get quizUser relation "+e.message)})},e.quizAvailable=function(u){for(var i=0;i<e.quizUsers.length;i++){var n=e.quizUsers[i];if(n.user==u.id&&1==n.available)return userQuizAvailable.push(!0),!0}return userQuizAvailable.push(!1),!1},e.shareWithUser=function(u,i){quizUser={user:u.id,quiz:e.curQuiz.id},0==userQuizAvailable[i]?(quizUser.available=!0,updateQuizUser(quizUser).then(function(e){userQuizAvailable[i]=!0,u.saved=!0},function(e){alert("Unable to post quiz user relation "+e.message)})):(quizUser.available=!1,updateQuizUser(quizUser).then(function(e){userQuizAvailable[i]=!1,u.saved=!0},function(e){alert("Unable to update quiz user relation "+e.message)}))},e.loadPage=function(u){e.loadItems(),e.curUserId=u,e.usersQuizBtnClass="active"},getQuizUsers=function(e){return i.get("/dynoquiz/api/quiz/"+e+"/quizuser/")},updateQuizUser=function(e){return i.post("/dynoquiz/api/quiz/"+e.quiz+"/user/"+e.user+"/",e)},getUsers=function(){return i.get("/dynoquiz/api/user/")},getNonUsers=function(e){return i.get("/dynoquiz/api/quiz/"+e+"/nonuser")},postQuizUser=function(e){return i.post("/dynoquiz/api/quiz/"+e.quiz+"/user/"+e.user+"/",e)},getQuizzes=function(){return i.get("/dynoquiz/api/quiz/")},postQuiz=function(e){return i.post("/dynoquiz/api/quiz/",e)},deleteQuiz=function(e){return i["delete"]("/dynoquiz/api/quiz/"+e)}});